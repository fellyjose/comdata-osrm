// Packaging/modules magic dance. This code is inserted before all other
// code when the dist is built.
(function(e){var t;if(typeof define=="function"&&define.amd)define(["leaflet"],e);else if(typeof module!="undefined")t=require("leaflet"),module.exports=e(t);else{if(typeof window.L=="undefined")throw"Leaflet must be loaded first";e(window.L)}})(function(e){return function(){"use strict";e.Routing=e.Routing||{},e.Routing.Autocomplete=e.Class.extend({options:{timeout:500,blurTimeout:100,noResultsMessage:"No results found."},initialize:function(t,n,r,i){e.setOptions(this,i),this._elem=t,this._resultFn=i.resultFn?e.Util.bind(i.resultFn,i.resultContext):null,this._autocomplete=i.autocompleteFn?e.Util.bind(i.autocompleteFn,i.autocompleteContext):null,this._selectFn=e.Util.bind(n,r),this._container=e.DomUtil.create("div","leaflet-routing-geocoder-result"),this._resultTable=e.DomUtil.create("table","",this._container),e.DomEvent.addListener(this._elem,"input",this._keyPressed,this),e.DomEvent.addListener(this._elem,"keypress",this._keyPressed,this),e.DomEvent.addListener(this._elem,"keydown",this._keyDown,this),e.DomEvent.addListener(this._elem,"blur",function(){this._isOpen&&this.close()},this)},close:function(){e.DomUtil.removeClass(this._container,"leaflet-routing-geocoder-result-open"),this._isOpen=!1},_open:function(){var t=this._elem.nextSibling;this._container.parentElement||(t?this._elem.parentElement.insertBefore(this._container,t):this._elem.parentElement.appendChild(this._container),this._container.style.left=this._elem.offsetLeft+"px",this._container.style.top=this._elem.offsetTop+this._elem.offsetHeight+"px",this._container.style.width=this._elem.offsetWidth+"px"),e.DomUtil.addClass(this._container,"leaflet-routing-geocoder-result-open"),this._isOpen=!0},_setResults:function(t){var n,r,i,s;delete this._selection,this._results=t;while(this._resultTable.firstChild)this._resultTable.removeChild(this._resultTable.firstChild);for(n=0;n<t.length;n++)r=e.DomUtil.create("tr","",this._resultTable),r.setAttribute("data-result-index",n),i=e.DomUtil.create("td","",r),s=document.createTextNode(t[n].name),i.appendChild(s),e.DomEvent.addListener(i,"mousedown",e.DomEvent.preventDefault),e.DomEvent.addListener(i,"click",this._resultSelected(t[n]),this);n||(r=e.DomUtil.create("tr","",this._resultTable),i=e.DomUtil.create("td","leaflet-routing-geocoder-no-results",r),i.innerHTML=this.options.noResultsMessage),this._open(),t.length>0&&this._select(1)},_resultSelected:function(t){return e.bind(function(){this.close(),this._elem.value=t.name,this._lastCompletedText=t.name,this._selectFn(t)},this)},_keyPressed:function(t){var n;if(this._isOpen&&t.keyCode===13&&this._selection){n=parseInt(this._selection.getAttribute("data-result-index"),10),this._resultSelected(this._results[n])(),e.DomEvent.preventDefault(t);return}if(t.keyCode===13){this._complete(this._resultFn,!0);return}if(this._autocomplete&&document.activeElement===this._elem){this._timer&&clearTimeout(this._timer),this._timer=setTimeout(e.Util.bind(function(){this._complete(this._autocomplete)},this),this.options.timeout);return}this._unselect()},_select:function(t){var n=this._selection;n&&(e.DomUtil.removeClass(n.firstChild,"leaflet-routing-geocoder-selected"),n=n[t>0?"nextSibling":"previousSibling"]),n||(n=this._resultTable[t>0?"firstChild":"lastChild"]),n&&(e.DomUtil.addClass(n.firstChild,"leaflet-routing-geocoder-selected"),this._selection=n)},_unselect:function(){this._selection&&e.DomUtil.removeClass(this._selection.firstChild,"leaflet-routing-geocoder-selected"),delete this._selection},_keyDown:function(t){if(this._isOpen)switch(t.keyCode){case 38:this._select(-1),e.DomEvent.preventDefault(t);return;case 40:this._select(1),e.DomEvent.preventDefault(t);return}},_complete:function(e,t){function r(e){this._lastCompletedText=n,t&&e.length===1?this._resultSelected(e[0])():this._setResults(e)}var n=this._elem.value;if(!n)return;n!==this._lastCompletedText?e(n,r,this):t&&r.call(this,this._results)}})}(),function(){"use strict";e.Routing=e.Routing||{},e.Routing._jsonpCallbackId=0,e.Routing._jsonp=function(t,n,r,i){var s="_l_routing_machine_"+e.Routing._jsonpCallbackId++,o;t+="&"+i+"="+s,window[s]=e.Util.bind(n,r),o=document.createElement("script"),o.type="text/javascript",o.src=t,o.id=s,document.getElementsByTagName("head")[0].appendChild(o)},e.Routing.OSRM=e.Class.extend({options:{serviceUrl:"//router.project-osrm.org/viaroute",geometryPrecision:6},initialize:function(t){e.Util.setOptions(this,t),this._hints={locations:{}}},route:function(t,n,r){var i=this._buildRouteUrl(t);return e.Routing._jsonp(i,function(e){this._routeDone(e,t,n,r)},this,"jsonp"),this},_routeDone:function(e,t,n,r){r=r||n;if(e.status!==0){n.call(r,{status:e.status,message:e.message});return}var i=[{name:e.route_name.join(", "),coordinates:this._decode(e.route_geometry,this.options.geometryPrecision),instructions:this._convertInstructions(e.route_instructions),summary:this._convertSummary(e.route_summary),waypoints:e.via_points}],s;if(e.alternative_geometries)for(s=0;s<e.alternative_geometries.length;s++)i.push({name:e.alternative_names[s].join(", "),coordinates:this._decode(e.alternative_geometries[s],this.options.geometryPrecision),instructions:this._convertInstructions(e.alternative_instructions[s]),summary:this._convertSummary(e.alternative_summaries[s]),waypoints:e.via_points});this._saveHintData(e,t),n.call(r,null,i)},_buildRouteUrl:function(e){var t=[],n,r;for(var i=0;i<e.length;i++)n=this._locationKey(e[i].latLng),t.push("loc="+n),r=this._hints.locations[n],r&&t.push("hint="+r);return this.options.serviceUrl+"?"+"instructions=true&"+t.join("&")+(this._hints.checksum!==undefined?"&checksum="+this._hints.checksum:"")},_locationKey:function(e){return e.lat+","+e.lng},_saveHintData:function(e,t){var n=e.hint_data,r;this._hints={checksum:n.checksum,locations:{}};for(var i=n.locations.length-1;i>=0;i--)r=t[i].latLng,this._hints.locations[this._locationKey(r)]=n.locations[i]},_decode:function(e,t){var n=e.length,r=0,i=0,s=0,o=[];t=Math.pow(10,-t);while(r<n){var u,a=0,f=0;do u=e.charCodeAt(r++)-63,f|=(u&31)<<a,a+=5;while(u>=32);var l=f&1?~(f>>1):f>>1;i+=l,a=0,f=0;do u=e.charCodeAt(r++)-63,f|=(u&31)<<a,a+=5;while(u>=32);var c=f&1?~(f>>1):f>>1;s+=c,o.push([i*t,s*t])}return o},_convertSummary:function(e){return{totalDistance:e.total_distance,totalTime:e.total_time}},_convertInstructions:function(e){var t=[],n,r,i,s;for(n=0;n<e.length;n++)r=e[n],i=this._drivingDirectionType(r[0]),s=r[0].split("-"),i&&t.push({type:i,distance:r[2],time:r[4],road:r[1],direction:r[6],exit:s.length>1?s[1]:undefined,index:r[3]});return t},_drivingDirectionType:function(e){switch(parseInt(e,10)){case 1:return"Straight";case 2:return"SlightRight";case 3:return"Right";case 4:return"SharpRight";case 5:return"TurnAround";case 6:return"SharpLeft";case 7:return"Left";case 8:return"SlightRight";case 9:return"WaypointReached";case 10:return"Straight";case 11:case 12:return"Roundabout";case 15:return"DestinationReached";default:return null}}}),e.Routing.osrm=function(t){return new e.Routing.OSRM(t)}}(),function(){"use strict";e.Routing=e.Routing||{},e.Routing.Line=e.Class.extend({includes:e.Mixin.Events,options:{styles:[{color:"black",opacity:.15,weight:7},{color:"white",opacity:.8,weight:4},{color:"green",opacity:1,weight:2}],addWaypoints:!0},initialize:function(t,n){e.Util.setOptions(this,n),this._route=t,this._wpIndices=this._findWaypointIndices()},addTo:function(e){return e.addLayer(this),this},onAdd:function(t){var n=this._route.coordinates,r,i;this._map=t,this._layers=[];for(r=0;r<this.options.styles.length;r++)i=e.polyline(n,this.options.styles[r]).addTo(t),this.options.addWaypoints&&i.on("mousedown",this._onLineTouched,this),this._layers.push(i)},onRemove:function(e){var t;for(t=0;t<this._layers.length;t++)e.removeLayer(this._layers[t]);delete this._map},getBounds:function(){return e.latLngBounds(this._route.coordinates)},_findWaypointIndices:function(){var t=this._route.waypoints,n=[],r;for(r=0;r<t.length;r++)n.push(this._findClosestRoutePoint(e.latLng(t[r])));return n},_findClosestRoutePoint:function(e){var t=Number.MAX_VALUE,n,r,i;for(r=this._route.coordinates.length-1;r>=0;r--)i=e.distanceTo(this._route.coordinates[r]),i<t&&(n=r,t=i);return n},_findNearestWpBefore:function(e){var t=this._wpIndices.length-1;while(t>=0&&this._wpIndices[t]>e)t--;return t},_onLineTouched:function(e){var t=this._findNearestWpBefore(this._findClosestRoutePoint(e.latlng));this.fire("linetouched",{afterIndex:t,latlng:e.latlng})}}),e.Routing.line=function(t,n){return new e.Routing.Line(t,n)}}(),function(){"use strict";e.Routing=e.Routing||{},e.Routing.Itinerary=e.Control.extend({includes:e.Mixin.Events,options:{units:"metric",pointMarkerStyle:{radius:5,color:"#03f",fillColor:"white",opacity:1,fillOpacity:.7},summaryTemplate:"<h2>{name}</h2><h3>{distance}, {time}</h3>",distanceTemplate:"{value} {unit}",timeTemplate:"{time}",unitNames:{meters:"m",kilometers:"km",yards:"yd",miles:"mi",hours:"h",minutes:"m√≠n",seconds:"s"},containerClassName:"",alternativeClassName:"",minimizedClassName:"",itineraryClassName:"",roundingSensitivity:1,show:!0},initialize:function(t){e.setOptions(this,t)},onAdd:function(){return this._container=e.DomUtil.create("div","leaflet-routing-container leaflet-bar "+(this.options.show?"":"leaflet-routing-container-hide")+this.options.containerClassName),e.DomEvent.disableClickPropagation(this._container),e.DomEvent.addListener(this._container,"mousewheel",function(t){e.DomEvent.stopPropagation(t)}),this._container},onRemove:function(){},setAlternatives:function(e){var t,n,r;this._clearAlts(),this._routes=e;for(t=0;t<this._routes.length;t++)n=this._routes[t],r=this._createAlternative(n,t),this._container.appendChild(r),this._altElements.push(r);return this.fire("routeselected",{route:this._routes[0]}),this},show:function(){e.DomUtil.removeClass(this._container,"leaflet-routing-container-hide")},hide:function(){e.DomUtil.addClass(this._container,"leaflet-routing-container-hide")},_createAlternative:function(t,n){var r=e.DomUtil.create("div","leaflet-routing-alt "+this.options.alternativeClassName+(n>0?" leaflet-routing-alt-minimized "+this.options.minimizedClassName:""));return r.innerHTML=e.Util.template(this.options.summaryTemplate,{name:t.name,distance:this._formatDistance(t.summary.totalDistance),time:this._formatTime(t.summary.totalTime)}),e.DomEvent.addListener(r,"click",this._onAltClicked,this),r.appendChild(this._createItineraryTable(t)),r},_clearAlts:function(){var t,n;for(t=0;this._container&&t<this._container.children.length;t++)n=this._container.children[t],e.DomUtil.hasClass(n,"leaflet-routing-alt")&&(this._container.removeChild(n),t--);this._altElements=[]},_createItineraryTable:function(t){var n=e.DomUtil.create("table",this.options.itineraryClassName),r=e.DomUtil.create("tbody","",n),i,s,o,u;for(i=0;i<t.instructions.length;i++)s=t.instructions[i],o=e.DomUtil.create("tr","",r),u=e.DomUtil.create("td","",o),u.appendChild(document.createTextNode(this._instruction(s,i))),u=e.DomUtil.create("td","",o),u.appendChild(document.createTextNode(this._formatDistance(s.distance))),this._addRowListeners(o,t.coordinates[s.index]);return n},_addRowListeners:function(t,n){var r=this,i;e.DomEvent.addListener(t,"mouseover",function(){i=e.circleMarker(n,r.options.pointMarkerStyle).addTo(r._map)}),e.DomEvent.addListener(t,"mouseout",function(){i&&(r._map.removeLayer(i),i=null)}),e.DomEvent.addListener(t,"click",function(t){r._map.panTo(n),e.DomEvent.stopPropagation(t)})},_onAltClicked:function(t){var n,r,i,s,o;n=t.target||window.event.srcElement;while(!e.DomUtil.hasClass(n,"leaflet-routing-alt"))n=n.parentElement;if(e.DomUtil.hasClass(n,"leaflet-routing-alt-minimized"))for(r=0;r<this._altElements.length;r++)i=this._altElements[r],s=n===i,o=s?"removeClass":"addClass",e.DomUtil[o](i,"leaflet-routing-alt-minimized"),this.options.minimizedClassName&&e.DomUtil[o](i,this.options.minimizedClassName),s&&this.fire("routeselected",{route:this._routes[r]});e.DomEvent.stop(t)},_formatDistance:function(t){var n=this.options.unitNames,r,i;return this.options.units==="imperial"?(t/=1.609344,t>=1e3?i={value:this._round(t)/1e3,unit:n.miles}:i={value:this._round(t/1.76),unit:n.yards}):(r=this._round(t),i={value:r>=1e3?r/1e3:r,unit:r>=1e3?n.kilometers:n.meters}),e.Util.template(this.options.distanceTemplate,i)},_round:function(e){var t=Math.pow(10,(Math.floor(e/this.options.roundingSensitivity)+"").length-1),n=Math.floor(e/t),r=n>5?t:t/2;return Math.round(e/r)*r},_formatTime:function(e){return e>86400?Math.round(e/3600)+" h":e>3600?Math.floor(e/3600)+" h "+Math.round(e%3600/60)+" min":e>300?Math.round(e/60)+" min":e>60?Math.floor(e/60)+" min "+e%60+" s":e+" s"},_instruction:function(t,n){return t.type!==undefined?e.Util.template(this._getInstructionTemplate(t,n),e.extend({exit:this._formatOrder(t.exit),dir:this._dir[t.direction]},t)):t.text},_getInstructionTemplate:function(e,t){switch(e.type){case"Straight":return(t===0?"Head":"Continue")+" {dir}"+(e.road?" on {road}":"");case"SlightRight":return"Slight right"+(e.road?" onto {road}":"");case"Right":return"Right"+(e.road?" onto {road}":"");case"SharpRight":return"Sharp right"+(e.road?" onto {road}":"");case"TurnAround":return"Turn around";case"SharpLeft":return"Sharp left"+(e.road?" onto {road}":"");case"Left":return"Left"+(e.road?" onto {road}":"");case"SlightLeft":return"Slight left"+(e.road?" onto {road}":"");case"WaypointReached":return"Waypoint reached";case"Roundabout":return"Take the {exit} exit in the roundabout";case"DestinationReached":return"Destination reached"}},_formatOrder:function(e){var t=e%10-1,n=["st","nd","rd"];return n[t]?e+n[t]:e+"th"},_dir:{N:"north",NE:"northeast",E:"east",SE:"southeast",S:"south",SW:"southwest",W:"west",NW:"northwest"}}),e.Routing.Itinerary._instructions={},e.Routing.itinerary=function(t){return new e.Routing.Itinerary(t)}}(),function(){"use strict";var t=e.Class.extend({initialize:function(e,t){this.latLng=e,this.name=t}});e.Routing=e.Routing||{},e.Routing.Plan=e.Class.extend({includes:e.Mixin.Events,options:{dragStyles:[{color:"black",opacity:.15,weight:7},{color:"white",opacity:.8,weight:4},{color:"orange",opacity:1,weight:2,dashArray:"7,12"}],draggableWaypoints:!0,addWaypoints:!0,maxGeocoderTolerance:200,autocompleteOptions:{},geocodersClassName:"",geocoderPlaceholder:function(e,t){return e===0?"Start":e<t-1?"Via "+e:"End"},geocoderClass:function(){return""}},initialize:function(t,n){e.Util.setOptions(this,n),this._waypoints=[],this.setWaypoints(t)},isReady:function(){var e;for(e=0;e<this._waypoints.length;e++)if(!this._waypoints[e].latLng)return!1;return!0},getWaypoints:function(){var e,t=[];for(e=0;e<this._waypoints.length;e++)t.push(this._waypoints[e]);return t},setWaypoints:function(e){var t=[0,this._waypoints.length].concat(e);return this.spliceWaypoints.apply(this,t),this},spliceWaypoints:function(){var e=[arguments[0],arguments[1]],n,r;for(n=2;n<arguments.length;n++)e.push(arguments[n]&&arguments[n].hasOwnProperty("latLng")?arguments[n]:new t(arguments[n]));[].splice.apply(this._waypoints,e);while(this._waypoints.length<2)r=new t,this._waypoints.push(r),e.push(r);this._updateMarkers(),this._fireChanged.apply(this,e)},onAdd:function(e){this._map=e,this._updateMarkers()},onRemove:function(){var e;this._removeMarkers();if(this._newWp)for(e=0;e<this._newWp.lines.length;e++)this._map.removeLayer(this._newWp.lines[e]);delete this._map},createGeocoders:function(){var t=e.DomUtil.create("div","leaflet-routing-geocoders "+this.options.geocodersClassName),n=this._waypoints,r,i,s;this._geocoderContainer=t,this._geocoderElems=[];for(r=0;r<n.length;r++)i=this._createGeocoder(r),t.appendChild(i),this._geocoderElems.push(i);return s=e.DomUtil.create("button","",t),s.setAttribute("type","button"),s.innerHTML="+",this.options.addWaypoints?e.DomEvent.addListener(s,"click",function(){this.spliceWaypoints(n.length,0,null)},this):s.style.display="none",this.on("waypointsspliced",this._updateGeocoders),t},_createGeocoder:function(t){var n=e.DomUtil.create("input",""),r=this._waypoints[t];return n.setAttribute("placeholder",this.options.geocoderPlaceholder(t,this._waypoints.length)),n.className=this.options.geocoderClass(t,this._waypoints.length),this._updateWaypointName(t,n),n.value=r.name,e.DomEvent.addListener(n,"click",function(){this.select()},n),new e.Routing.Autocomplete(n,function(e){n.value=e.name,r.name=e.name,r.latLng=e.center,this._updateMarkers(),this._fireChanged()},this,e.extend({resultFn:this.options.geocoder.geocode,resultContext:this.options.geocoder,autocompleteFn:this.options.geocoder.suggest,autocompleteContext:this.options.geocoder},this.options.autocompleteOptions)),n},_updateGeocoders:function(e){var t=[],n,r,i;e.index>=this._geocoderElems.length?i=this._geocoderContainer.lastChild:i=this._geocoderElems[e.index];for(n=0;n<e.added.length;n++)r=this._createGeocoder(e.index+n),this._geocoderContainer.insertBefore(r,i),t.push(r);for(n=e.index;n<e.index+e.nRemoved;n++)this._geocoderContainer.removeChild(this._geocoderElems[n]);t.splice(0,0,e.index,e.nRemoved),[].splice.apply(this._geocoderElems,t);for(n=0;n<this._geocoderElems.length;n++)this._geocoderElems[n].placeholder=this.options.geocoderPlaceholder(n,this._waypoints.length),this._geocoderElems[n].className=this.options.geocoderClass(n,this._waypoints.length)},_updateGeocoder:function(e,t){var n=this._waypoints[e],r=n&&n.name?n.name:"";t.value=r},_updateWaypointName:function(e,t,n){var r=this._waypoints[e];r.name=r.name||"",r.latLng&&(n||!r.name)&&(this.options.geocoder&&this.options.geocoder.reverse?this.options.geocoder.reverse(r.latLng,67108864,function(n){n.length>0&&n[0].center.distanceTo(r.latLng)<this.options.maxGeocoderTolerance?r.name=n[0].name:r.name="",this._updateGeocoder(e,t)},this):r.name="",this._updateGeocoder(e,t))},_removeMarkers:function(){var e;if(this._markers)for(e=0;e<this._markers.length;e++)this._markers[e]&&this._map.removeLayer(this._markers[e]);this._markers=[]},_updateMarkers:function(){var e,t,n;if(!this._map)return;this._removeMarkers();for(e=0;e<this._waypoints.length;e++)this._waypoints[e].latLng?(t=typeof this.options.waypointIcon=="function"?this.options.waypointIcon(e,this._waypoints[e].name,this._waypoints.length):this.options.waypointIcon,n=this._createMarker(t,e),this.options.draggableWaypoints&&this._hookWaypointEvents(n,e)):n=null,this._markers.push(n)},_createMarker:function(t,n){var r={draggable:!0};return t&&(r.icon=t),e.marker(this._waypoints[n].latLng,r).addTo(this._map)},_fireChanged:function(){this.fire("waypointschanged",{waypoints:this.getWaypoints()}),arguments.length>=2&&this.fire("waypointsspliced",{index:Array.prototype.shift.call(arguments),nRemoved:Array.prototype.shift.call(arguments),added:arguments})},_hookWaypointEvents:function(e,t){e.on("dragstart",function(e){this.fire("waypointdragstart",this._createWaypointEvent(t,e))},this),e.on("drag",function(e){this.fire("waypointdrag",this._createWaypointEvent(t,e))},this),e.on("dragend",function(e){this.fire("waypointdragend",this._createWaypointEvent(t,e)),this._waypoints[t].latLng=e.target.getLatLng(),this._waypoints[t].name="",this._updateWaypointName(t,this._geocoderElems[t],!0),this._fireChanged()},this)},_createWaypointEvent:function(e,t){return{index:e,latlng:t.target.getLatLng()}},dragNewWaypoint:function(t){var n;this._newWp={afterIndex:t.afterIndex,marker:e.marker(t.latlng).addTo(this._map),lines:[]};for(n=0;n<this.options.dragStyles.length;n++)this._newWp.lines.push(e.polyline([this._waypoints[t.afterIndex].latLng,t.latlng,this._waypoints[t.afterIndex+1].latLng],this.options.dragStyles[n]).addTo(this._map));this._markers.splice(t.afterIndex+1,0,this._newWp.marker),this._map.on("mousemove",this._onDragNewWp,this),this._map.on("mouseup",this._onWpRelease,this)},_onDragNewWp:function(e){var t;this._newWp.marker.setLatLng(e.latlng);for(t=0;t<this._newWp.lines.length;t++)this._newWp.lines[t].spliceLatLngs(1,1,e.latlng)},_onWpRelease:function(e){var t;this._map.off("mouseup",this._onWpRelease,this),this._map.off("mousemove",this._onDragNewWp,this);for(t=0;t<this._newWp.lines.length;t++)this._map.removeLayer(this._newWp.lines[t]);this.spliceWaypoints(this._newWp.afterIndex+1,0,e.latlng),delete this._newWp}}),e.Routing.plan=function(t,n){return new e.Routing.Plan(t,n)}}(),function(){"use strict";e.Routing.Control=e.Routing.Itinerary.extend({options:{fitSelectedRoutes:!0},initialize:function(t){e.Util.setOptions(this,t),this._router=this.options.router||new e.Routing.OSRM(t),this._plan=this.options.plan||e.Routing.plan(undefined,{geocoder:this.options.geocoder}),this.options.geocoder&&(this._plan.options.geocoder=this.options.geocoder),this.options.waypoints&&this._plan.setWaypoints(this.options.waypoints),e.Routing.Itinerary.prototype.initialize.call(this,t),this.on("routeselected",this._routeSelected,this),this._plan.on("waypointschanged",function(e){this._route(),this.fire("waypointschanged",{waypoints:e.waypoints})},this),this._route()},onAdd:function(t){var n=e.Routing.Itinerary.prototype.onAdd.call(this,t);return this._map=t,this._map.addLayer(this._plan),this.options.geocoder&&n.insertBefore(this._plan.createGeocoders(),n.firstChild),n},onRemove:function(t){return this._line&&t.removeLayer(this._line),t.removeLayer(this._plan),e.Routing.Itinerary.prototype.onRemove.call(this,t)},getWaypoints:function(){return this._plan.getWaypoints()},setWaypoints:function(e){return this._plan.setWaypoints(e),this},spliceWaypoints:function(){var e=this._plan.spliceWaypoints.apply(this._plan,arguments);return e},getPlan:function(){return this._plan},_routeSelected:function(t){var n=t.route;this._clearLine(),this._line=e.Routing.line(n,this.options.lineOptions),this._line.addTo(this._map),this._hookEvents(this._line),this.options.fitSelectedRoutes&&this._map.fitBounds(this._line.getBounds())},_hookEvents:function(e){e.on("linetouched",function(e){this._plan.dragNewWaypoint(e)},this)},_route:function(){var e;this._clearLine(),this._clearAlts(),this._plan.isReady()&&(e=this._plan.getWaypoints(),this.fire("routingstart",{waypoints:e}),this._router.route(e,function(t,n){if(t){this.fire("routingerror",{error:t});return}this.fire("routesfound",{waypoints:e,routes:n}),this.setAlternatives(n)},this))},_clearLine:function(){this._line&&(this._map.removeLayer(this._line),delete this._line)}}),e.Routing.control=function(t){return new e.Routing.Control(t)}}(),e.Routing});